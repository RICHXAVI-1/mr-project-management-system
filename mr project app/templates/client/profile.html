{% extends 'client/base.html' %}

{% block title %}My Profile - MR PROJECT{% endblock %}

{% block client_title %}My Profile{% endblock %}

{% block client_content %}
<div class="row">
    <div class="col-md-8">
        <!-- Personal Information Section -->
        <div class="profile-section">
            <div class="profile-heading">
                <h4><i class="fas fa-user-circle text-primary me-2"></i> Personal Information</h4>
            </div>
            
            <form method="POST" action="{{ url_for('client_profile') }}">
                {{ form.hidden_tag() }}
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        {{ form.name.label(class="form-label") }}
                        {{ form.name(class="form-control") }}
                        {% if form.name.errors %}
                            <div class="text-danger">
                                {% for error in form.name.errors %}
                                    <small>{{ error }}</small>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-control" value="{{ current_user.email }}" readonly>
                        <small class="form-text text-muted">Email cannot be changed</small>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        {{ form.phone.label(class="form-label") }}
                        {{ form.phone(class="form-control") }}
                        {% if form.phone.errors %}
                            <div class="text-danger">
                                {% for error in form.phone.errors %}
                                    <small>{{ error }}</small>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Registration Date</label>
                        <input type="text" class="form-control" value="{{ current_user.created_at.strftime('%B %d, %Y') }}" readonly>
                    </div>
                </div>
                
                <div class="mb-3">
                    {{ form.topic_title.label(class="form-label") }}
                    {{ form.topic_title(class="form-control") }}
                    {% if form.topic_title.errors %}
                        <div class="text-danger">
                            {% for error in form.topic_title.errors %}
                                <small>{{ error }}</small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
                
                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    {{ form.submit(class="btn btn-primary") }}
                </div>
            </form>
        </div>
        
        <!-- Change Password Section -->
        <div class="profile-section">
            <div class="profile-heading">
                <h4><i class="fas fa-lock text-primary me-2"></i> Change Password</h4>
            </div>
            
            <form method="POST" action="{{ url_for('client_change_password') }}">
                {{ password_form.hidden_tag() }}
                
                <div class="mb-3">
                    {{ password_form.current_password.label(class="form-label") }}
                    {{ password_form.current_password(class="form-control") }}
                    {% if password_form.current_password.errors %}
                        <div class="text-danger">
                            {% for error in password_form.current_password.errors %}
                                <small>{{ error }}</small>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        {{ password_form.new_password.label(class="form-label") }}
                        {{ password_form.new_password(class="form-control") }}
                        {% if password_form.new_password.errors %}
                            <div class="text-danger">
                                {% for error in password_form.new_password.errors %}
                                    <small>{{ error }}</small>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    <div class="col-md-6">
                        {{ password_form.confirm_password.label(class="form-label") }}
                        {{ password_form.confirm_password(class="form-control") }}
                        {% if password_form.confirm_password.errors %}
                            <div class="text-danger">
                                {% for error in password_form.confirm_password.errors %}
                                    <small>{{ error }}</small>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    {{ password_form.submit(class="btn btn-primary") }}
                </div>
            </form>
        </div>
    </div>
    
    <div class="col-md-4">
        <!-- Account Summary Section -->
        <div class="profile-section">
            <div class="profile-heading">
                <h4><i class="fas fa-user-check text-primary me-2"></i> Account Summary</h4>
            </div>
            
            <div class="text-center mb-4">
                <div class="avatar-circle mx-auto" style="width: 100px; height: 100px;">
                    <span class="initials" style="font-size: 2.5rem;">{{ current_user.name[0] }}</span>
                </div>
                <h4 class="mt-3">{{ current_user.name }}</h4>
                <p class="text-muted">Client</p>
            </div>
            
            <div class="list-group mb-4">
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <span><i class="fas fa-envelope text-primary me-2"></i> Email</span>
                    <span>{{ current_user.email }}</span>
                </div>
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <span><i class="fas fa-phone text-primary me-2"></i> Phone</span>
                    <span>{{ current_user.phone }}</span>
                </div>
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <span><i class="fas fa-key text-primary me-2"></i> Approval Code</span>
                    <code>{{ current_user.approval_code }}</code>
                </div>
            </div>
            
            <div class="d-grid gap-2">
                <a href="{{ url_for('client_documents') }}" class="btn btn-outline-primary">
                    <i class="fas fa-file-alt me-2"></i> Manage Documents
                </a>
                <a href="{{ url_for('client_messages') }}" class="btn btn-outline-primary">
                    <i class="fas fa-envelope me-2"></i> Messages
                </a>
                <a href="https://wa.me/2348026612882" target="_blank" class="btn btn-outline-success">
                    <i class="fab fa-whatsapp me-2"></i> WhatsApp Support
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
